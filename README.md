# CausalNova

**CausalNova** — инновационный алгоритм поиска причинно-следственных связей в табличных данных. Проект сочетает стохастическое моделирование, гибридную метрику силы связи, bootstrap-устойчивость и автообъяснение с визуализацией.

---

## Концепция и назначение

- **Цель:** Автоматически выявлять направления и силу причинно-следственных связей между переменными в данных.
- **Особенности:**
  - Стохастический выбор направлений (симуляция DAG через Монте-Карло)
  - Гибридная метрика силы (корреляция + энтропия)
  - Проверка устойчивости через bootstrap
  - Автоматическое текстовое объяснение и визуализация
  - Поддержка NaN, категориальных и числовых данных

---

## Архитектура и этапы работы

1. **Инициализация графа:**
   - Строится скелет графа по условному тесту независимости (корреляция, p-value, поддержка NaN)
   - Категориальные признаки автоматически кодируются (one-hot)
2. **Стохастическое направление:**
   - Для каждого ребра симулируется направление с вероятностью \( P(dir) \propto e^{-\Delta H} \), где \( \Delta H \) — изменение энтропии
3. **Оценка силы связи:**
   - Гибридная метрика: \( C_{ij} = \frac{Cov(X_i, X_j)}{\sigma_{X_i}\sigma_{X_j}} \cdot e^{-\frac{|H(X_j|X_i) - H(X_j)|}{\tau}} \)
   - Фильтрация слабых связей (по порогу)
4. **Bootstrap-устойчивость:**
   - Пересчет структуры на подвыборках, оценка стабильности связей
5. **Объяснение и визуализация:**
   - Генерация отчета с силой и устойчивостью связей
   - Визуализация графа с весами

---

## Пример использования

```python
from CausalNova import CausalNova
import numpy as np

np.random.seed(42)
data = np.random.rand(1000, 5)
data[:, 4] = 2 * data[:, 0] + np.random.rand(1000) * 0.1  # X0 → X4
causal = CausalNova()
causal.fit(data)
print(causal.explain())
causal.visualize()
```

---

## Описание входных и выходных данных

- **Вход:**
  - numpy.ndarray (2D), pandas.DataFrame или смешанные данные (числовые + категориальные)
  - Поддержка NaN, категориальных признаков (автоматически кодируются)
- **Выход:**
  - Граф (networkx.DiGraph) с весами связей
  - Текстовое объяснение (метод explain)
  - Визуализация (метод visualize)

---

## Бенчмарк и тестирование

В проекте есть скрипт `benchmark_causalnova.py`, который:
- Генерирует синтетические данные с известной структурой
- Запускает CausalNova на разных сценариях (размер, шум, NaN, категории)
- Считает метрики: Precision, Recall, F1
- Выводит время работы и найденные связи

Запуск:
```bash
python benchmark_causalnova.py
```

---

## Требования и установка

- Python 3.8+
- numpy
- pandas
- networkx
- matplotlib
- scipy
- scikit-learn

Установка зависимостей:
```bash
pip install numpy pandas networkx matplotlib scipy scikit-learn
```

---

## Преимущества
- Уникальный стохастический подход к направлению связей
- Гибридная метрика (корреляция + энтропия)
- Устойчивость к шуму, пропускам, категориям
- Автоматическое объяснение и визуализация
- Масштабируемость (работает на больших данных)

## Ограничения
- Для production Big Data рекомендуется добавить параллелизм bootstrap
- Для сложных категориальных структур требуется ручная интерпретация
- Нет поддержки временных рядов (только табличные данные)

---

## Лицензия

MIT License

---

## Контакты и поддержка

- Автор: https://t.me/Inqusitive41


---

**CausalNova — современный инструмент для поиска причинно-следственных связей в ваших данных!** 